from src.encoder import Encoder


def test_get_string_embeddings():
    encoder = Encoder()
    result = encoder.get_embeddings(["Hi hello bonjour"])
    expected = [0.026891862973570824, -0.044515419751405716, -0.00844432320445776, 0.02226257137954235,
                0.061860378831624985, -0.0012276170309633017, 0.018283672630786896, -0.05767173692584038,
                0.06341171264648438, 0.06493614614009857, 0.020923709496855736, 0.026855802163481712,
                -0.03616270422935486, 0.023531977087259293, 0.00498089799657464, -0.06664104759693146,
                -0.01185219082981348, -0.04466988518834114, 0.033422019332647324, -0.05304524302482605,
                -0.041867125779390335, 0.057365160435438156, -0.004294600337743759, 0.05089269578456879,
                -0.06789097934961319, 0.020346717908978462, 0.04003366827964783, -0.014402194879949093,
                -0.029167471453547478, -0.009704572148621082, 0.06956597417593002, 0.06763540953397751,
                0.05224645882844925, -0.05195246636867523, 0.006579094100743532, -0.004483082797378302,
                0.02285369485616684, -0.015458216890692711, 0.04355325549840927, -0.021245872601866722,
                0.0197887122631073, 0.009135846979916096, -0.001995088066905737, -0.030169356614351273,
                0.037728819996118546, 0.06082706153392792, -0.059400107711553574, -0.06003211811184883,
                -0.026152513921260834, 0.039818741381168365, -0.06556941568851471, 0.030750542879104614,
                -0.008741515688598156, -0.05413927510380745, -0.01597566343843937, 0.03746029734611511,
                0.04682840034365654, -0.03189646080136299, -0.03062731958925724, 0.05427641049027443,
                0.024399790912866592, -0.05393911898136139, 0.05360167473554611, 0.037341877818107605,
                0.0699717253446579, 0.025072887539863586, 0.02674277313053608, 0.03431207686662674, 0.0663464292883873,
                -0.023100756108760834, 0.027326809242367744, 0.02961159497499466, -0.02035450004041195,
                -0.029818501323461533, -0.07163331657648087, -0.030684804543852806, -0.052772119641304016,
                0.0445856973528862, -0.049094587564468384, -0.03931792452931404, -0.06711690872907639,
                0.06138664856553078, -0.06313588470220566, -0.055718887597322464, 0.04501616954803467,
                0.024596093222498894, -0.007506501395255327, 0.02004864253103733, -0.027330735698342323,
                0.04879430681467056, -0.07221202552318573, 0.05491034686565399, -0.031066065654158592,
                -0.021430915221571922, -0.031071625649929047, -0.056360747665166855, -0.04763388633728027,
                0.023137567564845085, -0.06283582746982574, -0.049879468977451324, 0.046988360583782196,
                -0.04705542325973511, -0.034419067203998566, -0.031456317752599716, 0.0535246804356575,
                0.028073269873857498, 0.00802224688231945, 0.07198993861675262, -0.015077361837029457,
                0.013473398983478546, 0.04175589233636856, 0.06593208014965057, 0.029673852026462555,
                -0.0534311942756176, 0.046919722110033035, 0.0539168082177639, -0.02029614895582199,
                -0.008933039382100105, 0.04919111356139183, 0.06651851534843445, 0.03701738268136978,
                -0.056402333080768585, -0.012766356579959393, 0.050792042165994644, -0.004990030080080032,
                0.0054375906474888325, 0.04855930060148239, -0.04358381778001785, 0.053903352469205856,
                0.062354862689971924, 0.056562621146440506, 0.047718148678541183, 0.06970364600419998,
                0.07107611000537872, -0.02536783181130886, -0.03478340432047844, -0.05812776833772659,
                -0.040478840470314026, -0.05183357000350952, 0.00208135019056499, -0.013719762675464153,
                0.059526197612285614, 0.0439775176346302, 0.040192436426877975, 0.033714886754751205,
                -0.07354484498500824, 0.02897336706519127, -0.011839074082672596, -0.06246308237314224,
                0.0062550138682127, 0.026831503957509995, 0.05552586540579796, 0.028229521587491035,
                0.048546966165304184, -0.06096075847744942, 0.04685051739215851, -0.003739699022844434,
                -0.06203095614910126, -0.0227313581854105, -0.034594226628541946, -0.02787361480295658,
                0.041411980986595154, -0.06530551612377167, -0.015231423079967499, 0.07307884097099304,
                0.0017664297483861446, -0.04911632090806961, -0.004434011410921812, 0.030751174315810204,
                -0.05565044283866882, 0.05530025064945221, 0.05918304622173309, 0.04383347928524017,
                0.057433195412158966, -0.07284281402826309, -0.04898166283965111, -0.0623122900724411,
                -0.006485919002443552, 0.02638096548616886, 0.03686551749706268, 0.06431221216917038,
                -0.048856932669878006, 0.02181295119225979, 0.009748335927724838, -0.00413088733330369,
                -0.06470606476068497, 0.06608680635690689, -0.05026015266776085, 0.07295238971710205,
                0.037524688988924026, 0.022397827357053757, -0.01383662037551403, 0.06499924510717392,
                -0.06468072533607483, 0.03139694035053253, -0.006191194988787174, 0.05863160640001297,
                0.055908530950546265, 0.0017597083933651447, -0.025071976706385612, -0.063739113509655,
                0.022719068452715874, 0.040956951677799225, 0.07379074394702911, 0.002348610432818532,
                0.02522420510649681, 0.024871259927749634, 0.05521233752369881, -0.0054965270683169365,
                -0.0696704313158989, 0.07010749727487564, 0.019696133211255074, 0.06592993438243866,
                0.059273961931467056, -0.022179292514920235, 0.046430811285972595, -0.02994370460510254,
                -0.022204577922821045, 0.012612447142601013, 0.041664376854896545, -0.02875758334994316,
                0.06341937184333801, 0.03941849246621132, -0.06434030830860138, -0.06310736387968063,
                0.05529402568936348, 0.0035783040802925825, 0.023603547364473343, 0.040847405791282654,
                0.04024571180343628, 0.060437873005867004, 0.058277979493141174, 0.03524342551827431,
                0.07400073856115341, -0.019813187420368195, 0.03589929640293121, 0.07366462051868439,
                0.006194973364472389, 0.0057294066064059734, 0.05500160530209541, 0.025256574153900146,
                0.025116389617323875, 0.014322584494948387, -0.06424177438020706, -0.05165427550673485,
                0.03455439954996109, 0.019531434401869774, -0.04486352950334549, 0.01186174526810646,
                0.0566425584256649, -0.01022304967045784, 0.00573686184361577, -0.04706069454550743,
                0.07153024524450302, -0.006663700565695763, -0.0717601627111435, 0.0032654302194714546,
                -0.033606790006160736, 0.0006375245284289122, -0.010906262323260307, -0.0031081053894013166,
                0.06621093302965164, -0.05274360626935959, 0.05645940452814102, 0.036610376089811325,
                -0.02255789190530777, 0.030331971123814583, -0.06805194914340973, 0.03843631222844124,
                -0.011222954839468002, -0.03794015944004059, 0.07418981939554214, 0.0363844558596611,
                0.05613292381167412, 0.05944713577628136, 0.0064946673810482025, -0.051060471683740616,
                0.056577641516923904, 0.06891795992851257, 0.04480272904038429, -0.05125374346971512,
                0.018466981127858162, -0.03340110555291176, -0.0067126573994755745, -0.031613823026418686,
                -0.055075325071811676, 0.03836800903081894, 0.016934029757976532, -0.05775516480207443,
                0.04961598291993141, 0.035708554089069366, -0.010168804787099361, -0.029013104736804962,
                0.02082989737391472, 0.04795149713754654, 0.07017697393894196, 0.01447103451937437, -0.0655411034822464,
                -0.009670686908066273, 0.06452144682407379, -0.016147442162036896, -0.06574321538209915,
                0.04689929634332657, -0.03151168301701546, -0.050621792674064636, -0.02873530425131321,
                0.05546969547867775, 0.026981212198734283, -0.011813308112323284, 0.0025269833859056234,
                0.05863932520151138, -0.0002597126003820449, -0.045303795486688614, -0.012404515407979488,
                0.027902815490961075, 0.06509595364332199, 0.01952519826591015, -0.03952798619866371,
                0.029725145548582077, 0.0223030224442482, -0.042983707040548325, 0.04589534550905228,
                0.006699351128190756, 0.01998692750930786, 0.03837330639362335, 0.06691844761371613,
                0.04041924327611923, 0.06648288667201996, 0.05239778012037277, 0.018986809998750687,
                0.05983291193842888, -0.05820528417825699, 0.053271811455488205, -0.031862951815128326,
                -0.030990775674581528, -0.07000986486673355, 0.04007022827863693, 0.033821459859609604,
                0.042948316782712936, 0.005939812399446964, -0.060913264751434326, -0.02264772728085518,
                -0.0030042279977351427, 0.05768463388085365, 0.034821767359972, 0.003573786932975054,
                0.019942114129662514, -0.018204009160399437, 0.05976986140012741, 0.024461615830659866,
                -0.015126866288483143, -0.06626403331756592, -0.06474099308252335, 0.0063492306508123875,
                -0.009477534331381321, -0.052685897797346115, -0.07229597866535187, -0.010028363205492496,
                -0.061374835669994354, -0.04962872341275215, 0.060523755848407745, -0.01081104390323162,
                0.03138909488916397, -0.01602678745985031, 0.04377755895256996, 0.06577993184328079,
                -0.044339392334222794, 0.0666486993432045, -0.026948630809783936, -0.055229589343070984,
                0.041874904185533524, -0.05871110409498215, 0.04411545768380165, 0.06580295413732529,
                0.04295886307954788, 0.071906678378582, 0.04455888643860817, -0.027361232787370682, 0.06610900908708572,
                -0.03251278027892113, -0.03304256871342659, 0.04530251398682594, 0.04347772151231766,
                -0.012758203782141209, 0.037139199674129486, -0.028601935133337975, -0.0708305761218071,
                0.06300199031829834, 0.046564798802137375, 0.04167671129107475, 0.059223536401987076,
                0.02359806001186371, -0.0018334798514842987, -0.005463317967951298, 0.021180979907512665,
                -0.05246530473232269, 0.02377704344689846, -0.022859808057546616, 0.029270770028233528,
                0.0540616512298584, -0.0664658397436142, 0.03345305472612381, -0.015389258973300457,
                -0.004179023671895266, 0.04096061363816261, -0.06014595925807953, -0.04633151739835739,
                -0.05409155786037445, 0.06004513427615166, 0.01076324563473463, -0.03512488678097725,
                0.04289631545543671, -0.0006689968286082149, 0.013582533225417137, -0.04989240691065788,
                0.053158365190029144, 0.06540683656930923, 0.051784295588731766, -0.06958058476448059,
                0.05813046544790268, -0.05412999540567398, 0.05988131836056709, -0.062429800629615784,
                0.01973755843937397, 0.014554232358932495, 0.07219353318214417, -0.03021530620753765,
                0.02252301201224327, -0.011207270435988903, 0.06893166154623032, -0.06066855788230896,
                -0.01476234570145607, -0.04821653291583061, 0.0694236010313034, -0.011018979363143444,
                -0.055153269320726395, -0.017357127740979195, 0.03040163964033127, -0.040621593594551086,
                -0.004023554269224405, 0.05564369633793831, 0.05611953139305115, 0.05343030393123627,
                0.053339146077632904, -0.025599341839551926, -0.05303021892905235, 0.03550483658909798,
                -0.0007603988633491099, -0.06798063218593597, -0.02155759371817112, 0.008951036259531975,
                -0.06058496609330177, -0.0031583872623741627, -0.06532146036624908, -0.052630506455898285,
                -0.06524421274662018, -0.01051271054893732, -0.060115594416856766, 0.045230329036712646,
                -0.039615314453840256, 0.049764711409807205, -0.03398769721388817, -0.06075529009103775,
                -0.07384168356657028, -0.006592349149286747, -0.021017661318182945, -0.03519498556852341,
                -0.04614797979593277, 0.00909795518964529, 0.07378698885440826, 0.06839504837989807,
                0.05508212745189667, 0.06961017102003098, 0.034374937415122986, -0.06636112183332443,
                -0.04585807025432587, -0.060097306966781616, -0.021674005314707756, -0.03292067348957062,
                0.053251128643751144, -0.056654587388038635, 0.006522280164062977, 0.06284595280885696,
                0.0075262608006596565, 0.03048943541944027, 0.05414503812789917, -0.05195849388837814,
                -0.028714332729578018, 0.05647783726453781, 0.009026520885527134, -0.00485665537416935,
                -0.06912624835968018, -0.03032696433365345, 0.041487909853458405, -0.014278387650847435,
                -0.03417062386870384, 0.0011491681216284633, 0.037520632147789, 0.06999996304512024,
                0.059859056025743484, -0.034968405961990356, -9.853111987467855e-05, -0.030913295224308968,
                -0.05478412285447121, 0.022200867533683777, 0.07114067673683167, 0.04489037021994591,
                -0.025384502485394478, -0.004990495275706053, -0.021568410098552704, -0.0424581840634346,
                -0.0029545663855969906]
    assert result[0] == expected
